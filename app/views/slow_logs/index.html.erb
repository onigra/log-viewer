<%- model_class = SlowLog -%>
<h2>Slow Queries</h2>

<div class="row-fluid">
  <%= search_form_for @q do |f| %>

    <div class="span5">
      <!-- MATCH -->
      <h4>Match</h4>
      <%= f.text_field :server_cont, :include_blank => true, :placeholder => 'DB Server HostName', :class => "input-small" %>
      <%= f.text_field :user_cont, :include_blank => true, :placeholder => 'Execute User', :class => "input-small" %>
      <%= f.text_field :host_cont, :include_blank => true, :placeholder => 'App Host Ip' %>
    </div>

    <div class="span5">
      <!-- NOT -->
      <h4>Not</h4>
      <%= f.text_field :server_not_in, :include_blank => true, :placeholder => 'Server', :class => "input-small" %>
      <%= f.text_field :user_not_in, :include_blank => true, :placeholder => 'User', :class => "input-small" %>
      <%= f.text_field :host_not_in, :include_blank => true, :placeholder => 'Host' %>
    </div>

    <div class="span11">
      <div class="form-search">
        <h4>Execute Time</h4>
        <%= f.text_field :created_at_gteq, :include_blank => true, :class => "datepicker", :placeholder => "From Date" %> ã€œ 
        <%= f.text_field :created_at_lteq, :include_blank => true, :class => "datepicker", :placeholder => "To Date" %>
        <%= f.submit "Search", :class => "btn btn-warning" %>
      </div>
    </div>

  <% end%>
</div>
<br />

<%= paginate @slow_logs %>

<table class="table table-striped">
  <thead>
    <tr>
      <th><%=t '.actions', :default => t("helpers.actions") %></th>
      <th><%= model_class.human_attribute_name(:server) %></th>
      <th><%= model_class.human_attribute_name(:user) %></th>
      <th><%= model_class.human_attribute_name(:host) %></th>
      <th><%= model_class.human_attribute_name(:query_time) %></th>
      <th><%= model_class.human_attribute_name(:lock_time) %></th>
      <th><%= model_class.human_attribute_name(:rows_sent) %></th>
      <th><%= model_class.human_attribute_name(:rows_examined) %></th>
      <th><%= model_class.human_attribute_name(:execute) %></th>
      <th><%= model_class.human_attribute_name(:created_at) %></th>
    </tr>
  </thead>
  <tbody>
    <% @slow_logs.each do |slow_log| %>
      <tr>
        <td><%= link_to t('.show', :default => t("helpers.links.show")), slow_log_path(slow_log), :class => 'btn btn-info btn-mini' %></td>
        <td><%= slow_log.server %></td>
        <td><%= slow_log.user %></td>
        <td><%= slow_log.host %></td>
        <td><%= slow_log.query_time %></td>
        <td><%= slow_log.lock_time %></td>
        <td><%= slow_log.rows_sent %></td>
        <td><%= slow_log.rows_examined %></td>
        <td><pre class="prettyprint"><%= slow_log.execute %></pre></td>
        <td><%= slow_log.created_at.strftime("%Y-%m-%d %H:%M:%S") %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<%= paginate @slow_logs %>

